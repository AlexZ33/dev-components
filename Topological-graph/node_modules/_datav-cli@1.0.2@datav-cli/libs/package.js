var root    = process.cwd();
var path    = require('path');
var fs      = require('fs-extra');
var pack    = require('./utils/pack');
var request = require('./utils/request');
var log     = require('./utils/log');

module.exports = function(configSys, root) {
  var packageCFG;
  if (typeof root !== 'string') {
    root = process.cwd();
  } else {
    root = path.join(process.cwd(), root);
  }
  // log.debug('root:', root)
  try {
    packageCFG = require(path.join(root, 'package.json'));
  } catch (e) {
    return log.err('parse package.json failed')
  }
  pack(packageCFG, path.join(root, '../'), root, configSys, function(err){
    if (err) {
      return log.err(err);
    } else {
      log.info('package success!')
    }
  });
}
